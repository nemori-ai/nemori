# Nemori：自然启发的情景记忆系统

*其他语言版本: [English](README.md)*

## 项目概述

Nemori-AI 旨在让大语言模型具备类人的情景记忆能力。
Nemori 通过自然、事件化的索引方式，帮助系统在关键时刻精准回溯原始经历。
愿景：让每一次数据交互，都能像人类记忆一样被理解、被回忆、被延续。

Nemori 源自我们团队 Tanka.ai 项目中记忆系统的情景记忆索引模块——这是一个我们计划开源的 MVP 实现。其核心目标是分享我们通过自然启发的情景记忆来构建记忆索引的方法。

虽然 Mem0、Letta、Supermemory、ZEP、MemOS 等先前系统在 AI 记忆方面做出了卓越尝试，在 LoCoMo 基准测试中取得了先进的性能，但 Nemori 引入了一种创新且简约的方法，专注于与人类情景记忆模式保持一致。鉴于最近优秀的开源项目和记忆系统研究的涌现，我们都汇聚在使用 LoCoMo 数据集作为基准，因此我们决定用展示我们情景记忆索引方法的 MVP 实现参与这一基准测试。

## 实验结果

为了突出 Nemori 这个简洁方法的优越性，我们在 LoCoMo 基准测试上进行了评估，与先前的最先进方法进行了比较：

### LoCoMo 基准测试结果

在 LoCoMo（长上下文对话建模）数据集上，Nemori 展现了卓越的性能：

![LoCoMo Benchmark Results](figures/locomo-scores.png)

![LoCoMo Benchmark Details](figures/locomo-detail-scores.png)

## 复现方法（Reproduction Guide）

要复现 Nemori 在 LoCoMo 基准测试上的实验结果，请参考 [evaluation/README.md](evaluation/README.md) 获取详细的评测环境搭建与运行步骤。

## 设计理念

当我们人类回忆过去的事件时，我们的脑海中经常闪现相关的图像、动作或声音。我们的大脑通过让我们重新体验当时发生的事情来帮助我们记忆——这种记忆机制被称为情景记忆。

Nemori 的设计灵感来自人类的情景记忆。Nemori 可以自主地将人与人、人与 AI 智能体或 AI 智能体之间的对话重塑为情景片段。与原始对话相比，情景片段具有更连贯的因果关系和时间表达能力。更重要的是，情景片段的表达在某种程度上与我们人类记忆回忆的粒度相一致，这意味着作为人类，我们更可能提出关于情景片段的问题，这些问题在语义上更接近情景片段本身，而不是原始消息。

### 颗粒度与大模型训练分布的对齐

我们设计中的一个关键洞察是，情景记忆颗粒度对齐为大语言模型提供了潜在的优化收益。由于大模型的训练数据集会对齐人类世界的文本分布，所以对齐回忆颗粒度的同时，也在对齐「自然世界中最大概率的事件表述颗粒度」。

这种对齐提供了几个优势：
- **减少分布偏移**：当存储的情景片段与训练语料中的典型事件跨度匹配时，回忆提示更接近预训练分布，提高了 token 预测概率
- **增强检索精度**：存储「人类尺度」事件的记忆索引操作的是语义纠缠较少的单元，提高了检索中的信噪比

## 技术实现方法

### 数据预处理

由于我们的生产系统增量处理原始情景数据，我们重用了主题分割策略。这体现了情景记忆创建的核心哲学："与人类记忆事件情景的粒度保持一致"。虽然我们的方法可能看起来低效且简单，但这反映了我们 MVP 为了清晰展示方法而做出的简化。在生产环境中，我们采用更具成本效益和高效的方法。

对于情景生成，我们选择了最直接的版本来最好地说明我们的方法，仅使用 gpt-4o-mini/gpt-4.1-mini 进行情景记忆提取。

### 检索策略

我们为每个用户的情景记忆建立了最小的 BM25 索引。这可能会引起疑问，但这同样是一种简化。我们的生产系统采用结合稀疏（BM25）和密集（向量检索）方法的混合检索策略，以平衡召回和语义匹配能力，并针对特定业务需求定制不同的重排策略。

在预处理完成后，后续过程相对简单。我们检索前 20 个结果，让 gpt-4o-mini/gpt-4.1-mini 生成响应，并遵循与其他项目几乎相同的评估方法。

## 未来路线图

1. 仅仅拥有特定事件的情景记忆是不够的。我们希望通过相似性度量等方法聚合情景片段，形成更长期和通用的高级情景片段。

2. 我们从拟人化的角度设计了 Nemori。我们仍然不确定未来 AI 助手的记忆机制是否会与人类根本不同。我们将在这方面进行更深入的思考。

## 特别感谢

MemOS 团队——我们从他们的项目中分叉并扩展了评估框架以支持 Nemori 基准测试。

**Nemori** - 赋予 AI 智能体长期记忆以驱动其自我进化 🚀 